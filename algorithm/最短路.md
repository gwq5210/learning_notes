# æœ€çŸ­è·¯

## å®šä¹‰

ï¼ˆè¿˜è®°å¾—è¿™äº›å®šä¹‰å—ï¼Ÿåœ¨é˜…è¯»ä¸‹åˆ—å†…å®¹ä¹‹å‰ï¼Œè¯·åŠ¡å¿…äº†è§£ å›¾è®ºç›¸å…³æ¦‚å¿µ ä¸­çš„åŸºç¡€éƒ¨åˆ†ã€‚ï¼‰

- è·¯å¾„
- æœ€çŸ­è·¯
- æœ‰å‘å›¾ä¸­çš„æœ€çŸ­è·¯ã€æ— å‘å›¾ä¸­çš„æœ€çŸ­è·¯
- å•æºæœ€çŸ­è·¯ã€æ¯å¯¹ç»“ç‚¹ä¹‹é—´çš„æœ€çŸ­è·¯

## æ€§è´¨

- å¯¹äºè¾¹æƒä¸ºæ­£çš„å›¾ï¼Œä»»æ„ä¸¤ä¸ªç»“ç‚¹ä¹‹é—´çš„æœ€çŸ­è·¯ï¼Œä¸ä¼šç»è¿‡é‡å¤çš„ç»“ç‚¹ã€‚
- å¯¹äºè¾¹æƒä¸ºæ­£çš„å›¾ï¼Œä»»æ„ä¸¤ä¸ªç»“ç‚¹ä¹‹é—´çš„æœ€çŸ­è·¯ï¼Œä¸ä¼šç»è¿‡é‡å¤çš„è¾¹ã€‚
- å¯¹äºè¾¹æƒä¸ºæ­£çš„å›¾ï¼Œä»»æ„ä¸¤ä¸ªç»“ç‚¹ä¹‹é—´çš„æœ€çŸ­è·¯ï¼Œä»»æ„ä¸€æ¡çš„ç»“ç‚¹æ•°ä¸ä¼šè¶…è¿‡ nï¼Œè¾¹æ•°ä¸ä¼šè¶…è¿‡ n-1ã€‚

## è®°å·

ä¸ºäº†æ–¹ä¾¿å™è¿°ï¼Œè¿™é‡Œå…ˆç»™å‡ºä¸‹æ–‡å°†ä¼šç”¨åˆ°çš„ä¸€äº›è®°å·çš„å«ä¹‰ã€‚

- n ä¸ºå›¾ä¸Šç‚¹çš„æ•°ç›®ï¼Œm ä¸ºå›¾ä¸Šè¾¹çš„æ•°ç›®ï¼›
- s ä¸ºæœ€çŸ­è·¯çš„æºç‚¹ï¼›
- D(u) ä¸º s ç‚¹åˆ° u ç‚¹çš„ å®é™… æœ€çŸ­è·¯é•¿åº¦ï¼›
- dis(u) ä¸º s ç‚¹åˆ° u ç‚¹çš„ ä¼°è®¡ æœ€çŸ­è·¯é•¿åº¦ã€‚ä»»ä½•æ—¶å€™éƒ½æœ‰ dis(u) $\geq$ D(u)ã€‚ç‰¹åˆ«åœ°ï¼Œå½“æœ€çŸ­è·¯ç®—æ³•ç»ˆæ­¢æ—¶ï¼Œåº”æœ‰ dis(u)=D(u)ã€‚
- w(u,v) ä¸º (u,v) è¿™ä¸€æ¡è¾¹çš„è¾¹æƒã€‚

## Floyd ç®—æ³•

æ˜¯ç”¨æ¥æ±‚ä»»æ„ä¸¤ä¸ªç»“ç‚¹ä¹‹é—´çš„æœ€çŸ­è·¯çš„ã€‚

å¤æ‚åº¦æ¯”è¾ƒé«˜ï¼Œä½†æ˜¯å¸¸æ•°å°ï¼Œå®¹æ˜“å®ç°ã€‚ï¼ˆæˆ‘ä¼šè¯´åªæœ‰ä¸‰ä¸ª for å—ï¼Ÿï¼‰

é€‚ç”¨äºä»»ä½•å›¾ï¼Œä¸ç®¡æœ‰å‘æ— å‘ï¼Œè¾¹æƒæ­£è´Ÿï¼Œä½†æ˜¯æœ€çŸ­è·¯å¿…é¡»å­˜åœ¨ã€‚ï¼ˆä¸èƒ½æœ‰ä¸ªè´Ÿç¯ï¼‰

### Floyd å®ç°

æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ•°ç»„ $f[k][x][y]$ï¼Œè¡¨ç¤ºåªå…è®¸ç»è¿‡ç»“ç‚¹ $1$ åˆ° $k$ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨å­å›¾ $V'={1, 2, \ldots, k}$ ä¸­çš„è·¯å¾„ï¼Œæ³¨æ„ï¼Œ$x$ ä¸ $y$ ä¸ä¸€å®šåœ¨è¿™ä¸ªå­å›¾ä¸­ï¼‰ï¼Œç»“ç‚¹ $x$ åˆ°ç»“ç‚¹ $y$ çš„æœ€çŸ­è·¯é•¿åº¦ã€‚

å¾ˆæ˜¾ç„¶ï¼Œ$f[n][x][y]$ å°±æ˜¯ç»“ç‚¹ $x$ åˆ°ç»“ç‚¹ $y$ çš„æœ€çŸ­è·¯é•¿åº¦ï¼ˆå› ä¸º $V'={1, 2, \ldots, n}$ å³ä¸º $V$ æœ¬èº«ï¼Œå…¶è¡¨ç¤ºçš„æœ€çŸ­è·¯å¾„å°±æ˜¯æ‰€æ±‚è·¯å¾„ï¼‰ã€‚

æ¥ä¸‹æ¥è€ƒè™‘å¦‚ä½•æ±‚å‡º $f$ æ•°ç»„çš„å€¼ã€‚

$f[0][x][y]$ï¼š$x$ ä¸ $y$ çš„è¾¹æƒï¼Œæˆ–è€… $0$ï¼Œæˆ–è€… $+\infty$ï¼ˆ$f[0][x][y]$ ä»€ä¹ˆæ—¶å€™åº”è¯¥æ˜¯ $+\infty$ï¼Ÿå½“ $x$ ä¸ $y$ é—´æœ‰ç›´æ¥ç›¸è¿çš„è¾¹çš„æ—¶å€™ï¼Œä¸ºå®ƒä»¬çš„è¾¹æƒï¼›å½“ $x = y$ çš„æ—¶å€™ä¸ºé›¶ï¼Œå› ä¸ºåˆ°æœ¬èº«çš„è·ç¦»ä¸ºé›¶ï¼›å½“ $x$ ä¸ $y$ æ²¡æœ‰ç›´æ¥ç›¸è¿çš„è¾¹çš„æ—¶å€™ï¼Œä¸º $+\infty$ï¼‰ã€‚

$f[k][x][y] = min(f[k-1][x][y], f[k-1][x][k]+f[k-1][k][y])$ï¼ˆ$f[k-1][x][y]$ï¼Œä¸ºä¸ç»è¿‡ $k$ ç‚¹çš„æœ€çŸ­è·¯å¾„ï¼Œè€Œ $f[k-1][x][k]+f[k-1][k][y]$ï¼Œä¸ºç»è¿‡äº† $k$ ç‚¹çš„æœ€çŸ­è·¯ï¼‰ã€‚

ä¸Šé¢ä¸¤è¡Œéƒ½æ˜¾ç„¶æ˜¯å¯¹çš„ï¼Œæ‰€ä»¥è¯´è¿™ä¸ªåšæ³•ç©ºé—´æ˜¯ $O(N^3)$ï¼Œæˆ‘ä»¬éœ€è¦ä¾æ¬¡å¢åŠ é—®é¢˜è§„æ¨¡ï¼ˆ$k$ ä» $1$ åˆ° $n$ï¼‰ï¼Œåˆ¤æ–­ä»»æ„ä¸¤ç‚¹åœ¨å½“å‰é—®é¢˜è§„æ¨¡ä¸‹çš„æœ€çŸ­è·¯ã€‚

Floyd-Warshallç®—æ³•çš„ä¼ªä»£ç æè¿°å¦‚ä¸‹ï¼š

```cpp
let dist be a |V| Ã— |V| array of minimum distances initialized to âˆ (infinity)
for each vertex v
  dist[v][v] â† 0
for each edge (u,v)
  dist[u][v] â† w(u,v)  // the weight of the edge (u,v)
for k from 1 to |V|
  for i from 1 to |V|
    for j from 1 to |V|
      if dist[i][j] > dist[i][k] + dist[k][j] 
        dist[i][j] â† dist[i][k] + dist[k][j]
      end if
```

å…¶ä¸­$dist[i][j]$è¡¨ç¤ºç”±ç‚¹$i$åˆ°ç‚¹$j$çš„ä»£ä»·ï¼Œå½“å…¶ä¸º $+\infty$ è¡¨ç¤ºä¸¤ç‚¹ä¹‹é—´æ²¡æœ‰ä»»ä½•è¿æ¥ã€‚

```cpp
for (k = 1; k <= n; k++) {
  for (x = 1; x <= n; x++) {
    for (y = 1; y <= n; y++) {
      f[k][x][y] = min(f[k - 1][x][y], f[k - 1][x][k] + f[k - 1][k][y]);
    }
  }
}
```

å› ä¸ºç¬¬ä¸€ç»´å¯¹ç»“æœæ— å½±å“ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°æ•°ç»„çš„ç¬¬ä¸€ç»´æ˜¯å¯ä»¥çœç•¥çš„ï¼Œäºæ˜¯å¯ä»¥ç›´æ¥æ”¹æˆ $f[x][y] = min(f[x][y], f[x][k]+f[k][y])$ã€‚

### è¯æ˜ç¬¬ä¸€ç»´å¯¹ç»“æœæ— å½±å“

æˆ‘ä»¬æ³¨æ„åˆ°å¦‚æœæ”¾åœ¨ä¸€ä¸ªç»™å®šç¬¬ä¸€ç»´ $k$ äºŒç»´æ•°ç»„ä¸­ï¼Œ$f[x][k]$ ä¸ $f[k][y]$ åœ¨æŸä¸€è¡Œå’ŒæŸä¸€åˆ—ã€‚è€Œ $f[x][y]$ åˆ™æ˜¯è¯¥è¡Œå’Œè¯¥åˆ—çš„äº¤å‰ç‚¹ä¸Šçš„å…ƒç´ ã€‚

ç°åœ¨æˆ‘ä»¬éœ€è¦è¯æ˜å°† $f[k][x][y]$ ç›´æ¥åœ¨åŸåœ°æ›´æ”¹ä¹Ÿä¸ä¼šæ›´æ”¹å®ƒçš„ç»“æœï¼šæˆ‘ä»¬æ³¨æ„åˆ° $f[k][x][y]$ çš„æ¶µä¹‰æ˜¯ç¬¬ä¸€ç»´ä¸º $k-1$ è¿™ä¸€è¡Œå’Œè¿™ä¸€åˆ—çš„æ‰€æœ‰å…ƒç´ çš„æœ€å°å€¼ï¼ŒåŒ…å«äº† $f[k-1][x][y]$ï¼Œé‚£ä¹ˆæˆ‘åœ¨åŸåœ°è¿›è¡Œæ›´æ”¹ä¹Ÿä¸ä¼šæ”¹å˜æœ€å°å€¼çš„å€¼ï¼Œå› ä¸ºå¦‚æœå°†è¯¥ä¸‰ç»´çŸ©é˜µå‹ç¼©ä¸ºäºŒç»´ï¼Œåˆ™æ‰€æ±‚ç»“æœ $f[x][y]$ ä¸€å¼€å§‹å³ä¸ºåŸ $f[k-1][x][y]$ çš„å€¼ï¼Œæœ€åä¾ç„¶ä¼šæˆä¸ºè¯¥è¡Œå’Œè¯¥åˆ—çš„æœ€å°å€¼ã€‚

æ•…å¯ä»¥å‹ç¼©ã€‚

```cpp
for (k = 1; k <= n; k++) {
  for (x = 1; x <= n; x++) {
    for (y = 1; y <= n; y++) {
      f[x][y] = min(f[x][y], f[x][k] + f[k][y]);
    }
  }
}
```

ç»¼ä¸Šæ—¶é—´å¤æ‚åº¦æ˜¯ $O(N^3)$ï¼Œç©ºé—´å¤æ‚åº¦æ˜¯ $O(N^2)$ã€‚

```cpp
#include <cstdio>
#include <vector>
#include <algorithm>
#include <numeric>

static constexpr int kInf = std::numeric_limits<int>::max() / 2;

struct Edge {
  int from = 0;
  int to = 0;
  int cost = 0;
};

void Floyd(int n, const std::vector<Edge>& edges, std::vector<std::vector<int>>& dis) {
  dis = std::vector<std::vector<int>>(n, std::vector<int>(n, kInf));
  for (auto& edge : edges) {
    dis[edge.from][edge.to] = edge.cost;
  }
  for (int i = 0; i < n; ++i) {
    dis[i][i] = 0;
  }
  for (int k = 0; k < n; ++k) {
    for (int u = 0; u < n; ++u) {
      for (int v = 0; v < n; ++v) {
        // dis[k][u][v] = std::min(dis[dis - 1][u][v], dis[k - 1][u][k] + dis[k - 1][k][v]);
        dis[u][v] = std::min(dis[u][v], dis[u][k] + dis[k][v]);
      }
    }
  }
}
```

## Bellman-Ford ç®—æ³•

`Bellman-Ford` ç®—æ³•æ˜¯ä¸€ç§åŸºäºæ¾å¼›ï¼ˆ`relax`ï¼‰æ“ä½œçš„æœ€çŸ­è·¯ç®—æ³•ï¼Œå¯ä»¥æ±‚å‡ºæœ‰è´Ÿæƒçš„å›¾çš„æœ€çŸ­è·¯ï¼Œå¹¶å¯ä»¥å¯¹æœ€çŸ­è·¯ä¸å­˜åœ¨çš„æƒ…å†µè¿›è¡Œåˆ¤æ–­ã€‚

åœ¨å›½å†… `OI` ç•Œï¼Œä½ å¯èƒ½å¬è¯´è¿‡çš„â€œSPFAâ€ï¼Œå°±æ˜¯ `Bellman-Ford` ç®—æ³•çš„ä¸€ç§å®ç°ã€‚

### Bellman-Ford è¿‡ç¨‹

å…ˆä»‹ç» `Bellman-Ford` ç®—æ³•è¦ç”¨åˆ°çš„æ¾å¼›æ“ä½œï¼ˆ`Dijkstra` ç®—æ³•ä¹Ÿä¼šç”¨åˆ°æ¾å¼›æ“ä½œï¼‰ã€‚

å¯¹äºè¾¹ $(u,v)$ï¼Œæ¾å¼›æ“ä½œå¯¹åº”ä¸‹é¢çš„å¼å­ï¼š$dis(v) = \min(dis(v), dis(u) + w(u, v))$ã€‚

è¿™ä¹ˆåšçš„å«ä¹‰æ˜¯æ˜¾ç„¶çš„ï¼šæˆ‘ä»¬å°è¯•ç”¨ $S \to u \to v$ï¼ˆå…¶ä¸­ $S \to u$ çš„è·¯å¾„å–æœ€çŸ­è·¯ï¼‰è¿™æ¡è·¯å¾„å»æ›´æ–° $v$ ç‚¹æœ€çŸ­è·¯çš„é•¿åº¦ï¼Œå¦‚æœè¿™æ¡è·¯å¾„æ›´ä¼˜ï¼Œå°±è¿›è¡Œæ›´æ–°ã€‚

`Bellman-Ford` ç®—æ³•æ‰€åšçš„ï¼Œå°±æ˜¯ä¸æ–­å°è¯•å¯¹å›¾ä¸Šæ¯ä¸€æ¡è¾¹è¿›è¡Œæ¾å¼›ã€‚æˆ‘ä»¬æ¯è¿›è¡Œä¸€è½®å¾ªç¯ï¼Œå°±å¯¹å›¾ä¸Šæ‰€æœ‰çš„è¾¹éƒ½å°è¯•è¿›è¡Œä¸€æ¬¡æ¾å¼›æ“ä½œï¼Œå½“ä¸€æ¬¡å¾ªç¯ä¸­æ²¡æœ‰æˆåŠŸçš„æ¾å¼›æ“ä½œæ—¶ï¼Œç®—æ³•åœæ­¢ã€‚

æ¯æ¬¡å¾ªç¯æ˜¯ $O(m)$ çš„ï¼Œé‚£ä¹ˆæœ€å¤šä¼šå¾ªç¯å¤šå°‘æ¬¡å‘¢ï¼Ÿ

åœ¨æœ€çŸ­è·¯å­˜åœ¨çš„æƒ…å†µä¸‹ï¼Œç”±äºä¸€æ¬¡æ¾å¼›æ“ä½œä¼šä½¿æœ€çŸ­è·¯çš„è¾¹æ•°è‡³å°‘ $+1$ï¼Œè€Œæœ€çŸ­è·¯çš„è¾¹æ•°æœ€å¤šä¸º $n-1$ï¼Œå› æ­¤æ•´ä¸ªç®—æ³•æœ€å¤šæ‰§è¡Œ $n-1$ è½®æ¾å¼›æ“ä½œã€‚æ•…æ€»æ—¶é—´å¤æ‚åº¦ä¸º $O(nm)$ã€‚

ä½†è¿˜æœ‰ä¸€ç§æƒ…å†µï¼Œå¦‚æœä» $S$ ç‚¹å‡ºå‘ï¼ŒæŠµè¾¾ä¸€ä¸ªè´Ÿç¯æ—¶ï¼Œæ¾å¼›æ“ä½œä¼šæ— ä¼‘æ­¢åœ°è¿›è¡Œä¸‹å»ã€‚æ³¨æ„åˆ°å‰é¢çš„è®ºè¯ä¸­å·²ç»è¯´æ˜äº†ï¼Œå¯¹äºæœ€çŸ­è·¯å­˜åœ¨çš„å›¾ï¼Œæ¾å¼›æ“ä½œæœ€å¤šåªä¼šæ‰§è¡Œ $n-1$ è½®ï¼Œå› æ­¤å¦‚æœç¬¬ $n$ è½®å¾ªç¯æ—¶ä»ç„¶å­˜åœ¨èƒ½æ¾å¼›çš„è¾¹ï¼Œè¯´æ˜ä» $S$ ç‚¹å‡ºå‘ï¼Œèƒ½å¤ŸæŠµè¾¾ä¸€ä¸ªè´Ÿç¯ã€‚

### è´Ÿç¯åˆ¤æ–­ä¸­å­˜åœ¨çš„å¸¸è§è¯¯åŒº

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä»¥ $S$ ç‚¹ä¸ºæºç‚¹è·‘ `Bellman-Ford` ç®—æ³•æ—¶ï¼Œå¦‚æœæ²¡æœ‰ç»™å‡ºå­˜åœ¨è´Ÿç¯çš„ç»“æœï¼Œåªèƒ½è¯´æ˜ä» $S$ ç‚¹å‡ºå‘ä¸èƒ½æŠµè¾¾ä¸€ä¸ªè´Ÿç¯ï¼Œè€Œä¸èƒ½è¯´æ˜å›¾ä¸Šä¸å­˜åœ¨è´Ÿç¯ã€‚

å› æ­¤å¦‚æœéœ€è¦åˆ¤æ–­æ•´ä¸ªå›¾ä¸Šæ˜¯å¦å­˜åœ¨è´Ÿç¯ï¼Œæœ€ä¸¥è°¨çš„åšæ³•æ˜¯å»ºç«‹ä¸€ä¸ªè¶…çº§æºç‚¹ï¼Œå‘å›¾ä¸Šæ¯ä¸ªèŠ‚ç‚¹è¿ä¸€æ¡æƒå€¼ä¸º $0$ çš„è¾¹ï¼Œç„¶åä»¥è¶…çº§æºç‚¹ä¸ºèµ·ç‚¹æ‰§è¡Œ `Bellman-Ford` ç®—æ³•ã€‚

### Bellman-Ford å®ç°

```cpp
struct edge {
  int v, w;
};

vector<edge> e[maxn];
int dis[maxn];
const int inf = 0x3f3f3f3f;

bool bellmanford(int n, int s) {
  memset(dis, 63, sizeof(dis));
  dis[s] = 0;
  bool flag;  // åˆ¤æ–­ä¸€è½®å¾ªç¯è¿‡ç¨‹ä¸­æ˜¯å¦å‘ç”Ÿæ¾å¼›æ“ä½œ
  for (int i = 1; i <= n; i++) {
    flag = false;
    for (int u = 1; u <= n; u++) {
      if (dis[u] == inf) continue;
      // æ— ç©·å¤§ä¸å¸¸æ•°åŠ å‡ä»ç„¶ä¸ºæ— ç©·å¤§
      // å› æ­¤æœ€çŸ­è·¯é•¿åº¦ä¸º inf çš„ç‚¹å¼•å‡ºçš„è¾¹ä¸å¯èƒ½å‘ç”Ÿæ¾å¼›æ“ä½œ
      for (auto ed : e[u]) {
        int v = ed.v, w = ed.w;
        if (dis[v] > dis[u] + w) {
          dis[v] = dis[u] + w;
          flag = true;
        }
      }
    }
    // æ²¡æœ‰å¯ä»¥æ¾å¼›çš„è¾¹æ—¶å°±åœæ­¢ç®—æ³•
    if (!flag) break;
  }
  // ç¬¬ n è½®å¾ªç¯ä»ç„¶å¯ä»¥æ¾å¼›æ—¶è¯´æ˜ s ç‚¹å¯ä»¥æŠµè¾¾ä¸€ä¸ªè´Ÿç¯
  return flag;
}
```

```cpp
#include <algorithm>
#include <cstdio>
#include <numeric>
#include <string>
#include <vector>

static constexpr int kInf = std::numeric_limits<int>::max() / 2;

struct Edge {
  int from = 0;
  int to = 0;
  int cost = 0;
};

// è¿”å›å€¼ä¸ºtrueè¡¨ç¤ºå­˜åœ¨è´Ÿç¯
// Bellman Ford éƒ½æ˜¯åŸºäºåŠ¨æ€è§„åˆ’ï¼Œå…¶åŸå§‹çš„çŠ¶æ€å®šä¹‰ä¸º f[i][k] ä»£è¡¨ä»èµ·ç‚¹åˆ° i ç‚¹ï¼Œä¸”ç»è¿‡æœ€å¤š k æ¡è¾¹çš„æœ€çŸ­è·¯å¾„ã€‚
// æˆ‘ä»¬ä¹Ÿå¯ä»¥è¿™æ ·å®šä¹‰f[k][i]ï¼Œåº”è¯¥æ˜¯ç­‰ä»·çš„
// è¿™æ ·çš„çŠ¶æ€å®šä¹‰å¼•å¯¼æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨ Bellman Ford æ¥è§£å†³æœ‰è¾¹æ•°é™åˆ¶çš„æœ€çŸ­è·¯é—®é¢˜ã€‚
bool DPBellmanFord(int n, int src, const std::vector<Edge>& edges, std::vector<std::vector<int>>& dis) {
  dis = std::vector<std::vector<int>>(n, std::vector<int>(n, kInf));
  // åˆå§‹çŠ¶æ€ï¼Œdis[src][0] = 0ï¼Œå…¶ä»–dis[i][0](i!=src)ä¸ºkInf
  dis[src][0] = 0;
  // flagä»£è¡¨æŸä¸€æ¬¡éå†æ˜¯å¦å‘ç”Ÿäº†æ¾å¼›
  bool flag = false;
  // æœ€å¤šæ‰§è¡Œn-1æ¬¡æ¾å¼›
  // å½“ç¬¬næ¬¡è¿˜å¯ä»¥æ¾å¼›æ—¶ï¼Œè¡¨ç¤ºä»srcå¯ä»¥åˆ°è¾¾ä¸€ä¸ªè´Ÿç¯
  for (int i = 1; i <= n; ++i) {
    flag = false;
    for (auto& edge : edges) {
      dis[edge.to][i] = dis[edge.to][i - 1];
      if (dis[edge.to][i] > dis[edge.from][i - 1] + edge.cost) {
        dis[edge.to][i] = dis[edge.from][i - 1] + edge.cost;
        flag = true;
      }
    }
    if (!flag) {
      break;
    }
  }
  return flag;
}

// è¿”å›å€¼ä¸ºtrueè¡¨ç¤ºå­˜åœ¨è´Ÿç¯
// ä¸Šè¿°çš„çŠ¶æ€è½¬ç§»ï¼Œåªä¸ä¸Šä¸€ç»´åº¦æœ‰å…³ç³»ï¼Œå¯ä»¥å°è¯•å°†ä¸Šä¸€ä¸ªç»´åº¦å»æ‰
bool BellmanFord(int n, int src, const std::vector<Edge>& edges, std::vector<int>& dis) {
  std::vector<std::vector<Edge>> adjs(n);
  dis = std::vector<int>(n, kInf);
  for (auto& edge : edges) {
    adjs[edge.from].emplace_back(edge);
  }
  dis[src] = 0;
  bool flag = false;
  for (int i = 1; i <= n; ++i) {
    flag = false;
    for (int u = 0; u < n; ++u) {
      for (auto& edge : adjs[u]) {
        // å°†ä¸Šä¸€ä¸ªç»´åº¦å»æ‰å, è¿™ä¸€è½®æ¾å¼›å¯èƒ½å‡ºç°æ‰€ä½¿ç”¨çš„è¾¹å¤§äºiæ¡
        // ä¾‹å¦‚å¯¹äºè¾¹u->v,ä½¿ç”¨çš„dis[u]ä¸èƒ½ä¿è¯æ˜¯ä¸Šä¸€è½®è¿›è¡Œçš„æ¾å¼›
        // å› ä¸ºå¯èƒ½å­˜åœ¨è¾¹a->uå·²ç»åœ¨è¾¹u->vä¹‹å‰æ›´æ–°è¿‡dis[u]äº†
        // å› æ­¤å…¶ä½¿ç”¨çš„è¾¹å¯èƒ½ä¼šå¤§äºiæ¡
        // å¦‚æœéœ€è¦æ±‚è§£æœ‰é™åˆ¶çš„æœ€çŸ­è·¯é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨åŸå§‹çš„åŠ¨æ€è§„åˆ’å®šä¹‰
        // ä¿è¯æ¯ä¸€è½®çš„è¾¹æ•°ä¸€å®šæ»¡è¶³éœ€æ±‚ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨æ»šåŠ¨æ•°ç»„æ¥é™ä½ç©ºé—´å¤æ‚åº¦
        if (dis[edge.from] + edge.cost < dis[edge.to]) {
          dis[edge.to] = dis[edge.from] + edge.cost;
          flag = true;
        }
      }
    }
    if (!flag) {
      break;
    }
  }
  return flag;
}

int main(int argc, char* argv[]) { return 0; }
```

### æœ‰é™åˆ¶çš„æœ€çŸ­è·¯

ã€Œé™åˆ¶æœ€å¤šç»è¿‡ä¸è¶…è¿‡ $k$ ä¸ªç‚¹ã€ç­‰ä»·äºã€Œé™åˆ¶æœ€å¤šä¸è¶…è¿‡ $k+1$ æ¡è¾¹ã€ï¼Œè€Œè§£å†³ã€Œæœ‰è¾¹æ•°é™åˆ¶çš„æœ€çŸ­è·¯é—®é¢˜ã€æ˜¯ `SPFA` æ‰€ä¸èƒ½å–ä»£ `Bellman Ford` ç®—æ³•çš„ç»å…¸åº”ç”¨ä¹‹ä¸€ï¼ˆ`SPFA` èƒ½åšï¼Œä½†ä¸èƒ½ç›´æ¥åšï¼‰ã€‚

`Bellman Ford` éƒ½æ˜¯åŸºäºåŠ¨æ€è§„åˆ’ï¼Œå…¶åŸå§‹çš„çŠ¶æ€å®šä¹‰ä¸º $f[i][k]$ ä»£è¡¨ä»èµ·ç‚¹åˆ° $i$ ç‚¹ï¼Œä¸”ç»è¿‡æœ€å¤š $k$ æ¡è¾¹çš„æœ€çŸ­è·¯å¾„ã€‚è¿™æ ·çš„çŠ¶æ€å®šä¹‰å¼•å¯¼æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨ `Bellman Ford` æ¥è§£å†³æœ‰è¾¹æ•°é™åˆ¶çš„æœ€çŸ­è·¯é—®é¢˜ã€‚

åŒæ ·å¤šæºæ±‡æœ€çŸ­è·¯ç®—æ³• `Floyd` ä¹Ÿæ˜¯åŸºäºåŠ¨æ€è§„åˆ’

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨éå†æ‰€æœ‰çš„â€œç‚¹å¯¹/è¾¹â€è¿›è¡Œæ¾å¼›æ“ä½œå‰ï¼Œéœ€è¦å…ˆå¯¹ `dis` è¿›è¡Œå¤‡ä»½ï¼Œå¦åˆ™ä¼šå‡ºç°ã€Œæœ¬æ¬¡æ¾å¼›æ“ä½œæ‰€ä½¿ç”¨åˆ°çš„è¾¹ï¼Œä¹Ÿæ˜¯åœ¨åŒä¸€æ¬¡è¿­ä»£æ‰€æ›´æ–°çš„ã€ï¼Œä»è€Œä¸æ»¡è¶³è¾¹æ•°é™åˆ¶çš„è¦æ±‚ã€‚ ä¸¾ä¸ª ğŸŒ°ï¼Œä¾‹å¦‚æœ¬æ¬¡æ¾å¼›æ“ä½œä½¿ç”¨äº†ä» `a` åˆ° `b` çš„å½“å‰æœ€çŸ­è·ç¦»æ¥æ›´æ–° `dis[b]`ï¼Œç›´æ¥ä½¿ç”¨ `dis[a]` çš„è¯ï¼Œä¸èƒ½ç¡®ä¿ `dis[a]` ä¸æ˜¯åœ¨åŒä¸€æ¬¡è¿­ä»£ä¸­æ‰€æ›´æ–°ï¼Œå¦‚æœ `dis[a]` æ˜¯åŒä¸€æ¬¡è¿­ä»£æ‰€æ›´æ–°çš„è¯ï¼Œé‚£ä¹ˆä½¿ç”¨çš„è¾¹æ•°å°†ä¼šå¤§äº `k` æ¡ã€‚ å› æ­¤åœ¨æ¯æ¬¡è¿­ä»£å¼€å§‹å‰ï¼Œæˆ‘ä»¬éƒ½åº”è¯¥å¯¹ `dis` è¿›è¡Œå¤‡ä»½ï¼Œåœ¨è¿­ä»£æ—¶ä½¿ç”¨å¤‡ä»½æ¥è¿›è¡Œæ¾å¼›æ“ä½œã€‚

## Dijkstra ç®—æ³•

Dijkstraï¼ˆ/ËˆdikstrÉ‘/æˆ–/ËˆdÉ›ikstrÉ‘/ï¼‰ç®—æ³•ç”±è·å…°è®¡ç®—æœºç§‘å­¦å®¶ E. W. Dijkstra äº 1956 å¹´å‘ç°ï¼Œ1959 å¹´å…¬å¼€å‘è¡¨ã€‚æ˜¯ä¸€ç§æ±‚è§£ éè´Ÿæƒå›¾ ä¸Šå•æºæœ€çŸ­è·¯å¾„çš„ç®—æ³•ã€‚

### Dijkstra è¿‡ç¨‹

å°†ç»“ç‚¹åˆ†æˆä¸¤ä¸ªé›†åˆï¼šå·²ç¡®å®šæœ€çŸ­è·¯é•¿åº¦çš„ç‚¹é›†ï¼ˆè®°ä¸º S é›†åˆï¼‰çš„å’Œæœªç¡®å®šæœ€çŸ­è·¯é•¿åº¦çš„ç‚¹é›†ï¼ˆè®°ä¸º T é›†åˆï¼‰ã€‚ä¸€å¼€å§‹æ‰€æœ‰çš„ç‚¹éƒ½å±äº T é›†åˆã€‚

åˆå§‹åŒ– `dis(s)=0`ï¼Œå…¶ä»–ç‚¹çš„ `dis` å‡ä¸º $+\infty$ã€‚

ç„¶åé‡å¤è¿™äº›æ“ä½œï¼š

- ä» T é›†åˆä¸­ï¼Œé€‰å–ä¸€ä¸ªæœ€çŸ­è·¯é•¿åº¦æœ€å°çš„ç»“ç‚¹ï¼Œç§»åˆ° S é›†åˆä¸­ã€‚
- å¯¹é‚£äº›åˆšåˆšè¢«åŠ å…¥ S é›†åˆçš„ç»“ç‚¹çš„æ‰€æœ‰å‡ºè¾¹æ‰§è¡Œæ¾å¼›æ“ä½œã€‚

ç›´åˆ° T é›†åˆä¸ºç©ºï¼Œç®—æ³•ç»“æŸã€‚

### æ—¶é—´å¤æ‚åº¦

æœ‰å¤šç§æ–¹æ³•æ¥ç»´æŠ¤ `1` æ“ä½œä¸­æœ€çŸ­è·¯é•¿åº¦æœ€å°çš„ç»“ç‚¹ï¼Œä¸åŒçš„å®ç°å¯¼è‡´äº† `Dijkstra` ç®—æ³•æ—¶é—´å¤æ‚åº¦ä¸Šçš„å·®å¼‚ã€‚

- æš´åŠ›ï¼šä¸ä½¿ç”¨ä»»ä½•æ•°æ®ç»“æ„è¿›è¡Œç»´æŠ¤ï¼Œæ¯æ¬¡ 2 æ“ä½œæ‰§è¡Œå®Œæ¯•åï¼Œç›´æ¥åœ¨ T é›†åˆä¸­æš´åŠ›å¯»æ‰¾æœ€çŸ­è·¯é•¿åº¦æœ€å°çš„ç»“ç‚¹ã€‚2 æ“ä½œæ€»æ—¶é—´å¤æ‚åº¦ä¸º O(m)ï¼Œ1 æ“ä½œæ€»æ—¶é—´å¤æ‚åº¦ä¸º O($n^2$)ï¼Œå…¨è¿‡ç¨‹çš„æ—¶é—´å¤æ‚åº¦ä¸º O($n^2 + m$) = O($n^2$)ã€‚
- äºŒå‰å †ï¼šæ¯æˆåŠŸæ¾å¼›ä¸€æ¡è¾¹ (u,v)ï¼Œå°±å°† v æ’å…¥äºŒå‰å †ä¸­ï¼ˆå¦‚æœ v å·²ç»åœ¨äºŒå‰å †ä¸­ï¼Œç›´æ¥ä¿®æ”¹ç›¸åº”å…ƒç´ çš„æƒå€¼å³å¯ï¼‰ï¼Œ1 æ“ä½œç›´æ¥å–å †é¡¶ç»“ç‚¹å³å¯ã€‚å…±è®¡ O(m) æ¬¡äºŒå‰å †ä¸Šçš„æ’å…¥ï¼ˆä¿®æ”¹ï¼‰æ“ä½œï¼ŒO(n) æ¬¡åˆ é™¤å †é¡¶æ“ä½œï¼Œè€Œæ’å…¥ï¼ˆä¿®æ”¹ï¼‰å’Œåˆ é™¤çš„æ—¶é—´å¤æ‚åº¦å‡ä¸º O($\log n$)ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O($(n+m) \log n$) = O($m \log n$)ã€‚
- ä¼˜å…ˆé˜Ÿåˆ—ï¼šå’ŒäºŒå‰å †ç±»ä¼¼ï¼Œä½†ä½¿ç”¨ä¼˜å…ˆé˜Ÿåˆ—æ—¶ï¼Œå¦‚æœåŒä¸€ä¸ªç‚¹çš„æœ€çŸ­è·¯è¢«æ›´æ–°å¤šæ¬¡ï¼Œå› ä¸ºå…ˆå‰æ›´æ–°æ—¶æ’å…¥çš„å…ƒç´ ä¸èƒ½è¢«åˆ é™¤ï¼Œä¹Ÿä¸èƒ½è¢«ä¿®æ”¹ï¼Œåªèƒ½ç•™åœ¨ä¼˜å…ˆé˜Ÿåˆ—ä¸­ï¼Œæ•…ä¼˜å…ˆé˜Ÿåˆ—å†…çš„å…ƒç´ ä¸ªæ•°æ˜¯ O(m) çš„ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O($m \log m$)ã€‚

åœ¨ç¨€ç–å›¾ä¸­ï¼Œm = O(n)ï¼Œä½¿ç”¨äºŒå‰å †å®ç°çš„ `Dijkstra` ç®—æ³•è¾ƒ `Bellman-Ford` ç®—æ³•å…·æœ‰è¾ƒå¤§çš„æ•ˆç‡ä¼˜åŠ¿ï¼›è€Œåœ¨ç¨ å¯†å›¾ä¸­ï¼Œm = O($n^2$)ï¼Œè¿™æ—¶å€™ä½¿ç”¨æš´åŠ›åšæ³•è¾ƒäºŒå‰å †å®ç°æ›´ä¼˜ã€‚

### æ­£ç¡®æ€§è¯æ˜

ä¸‹é¢ç”¨æ•°å­¦å½’çº³æ³•è¯æ˜ï¼Œåœ¨ **æ‰€æœ‰è¾¹æƒå€¼éè´Ÿ** çš„å‰æä¸‹ï¼Œ`Dijkstra` ç®—æ³•çš„æ­£ç¡®æ€§

ç®€å•æ¥è¯´ï¼Œæˆ‘ä»¬è¦è¯æ˜çš„ï¼Œå°±æ˜¯åœ¨æ‰§è¡Œ 1 æ“ä½œæ—¶ï¼Œå–å‡ºçš„ç»“ç‚¹ u æœ€çŸ­è·¯å‡å·²ç»è¢«ç¡®å®šï¼Œå³æ»¡è¶³ `D(u) = dis(u)`ã€‚

åˆå§‹æ—¶ S = $\varnothing$ï¼Œå‡è®¾æˆç«‹ã€‚

æ¥ä¸‹æ¥ç”¨åè¯æ³•ã€‚

è®¾ `u` ç‚¹ä¸ºç®—æ³•ä¸­ç¬¬ä¸€ä¸ªåœ¨åŠ å…¥ `S` é›†åˆæ—¶ä¸æ»¡è¶³ `D(u) = dis(u)` çš„ç‚¹ã€‚å› ä¸º `s` ç‚¹ä¸€å®šæ»¡è¶³ `D(u)=dis(u)=0`ï¼Œä¸”å®ƒä¸€å®šæ˜¯ç¬¬ä¸€ä¸ªåŠ å…¥ `S` é›†åˆçš„ç‚¹ï¼Œå› æ­¤å°† u åŠ å…¥ S é›†åˆå‰ï¼Œ$S \neq \varnothing$ï¼Œå¦‚æœä¸å­˜åœ¨ s åˆ° u çš„è·¯å¾„ï¼Œåˆ™ $D(u) = dis(u) = +\infty$ï¼Œä¸å‡è®¾çŸ›ç›¾ã€‚

äºæ˜¯ä¸€å®šå­˜åœ¨è·¯å¾„ $s \to x \to y \to u$ï¼Œå…¶ä¸­ $y$ ä¸º $s \to u$ è·¯å¾„ä¸Šç¬¬ä¸€ä¸ªå±äº $T$ é›†åˆçš„ç‚¹ï¼Œè€Œ $x$ ä¸º $y$ çš„å‰é©±ç»“ç‚¹ï¼ˆæ˜¾ç„¶ $x \in S$ï¼‰ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¯èƒ½å­˜åœ¨ $s = x$ æˆ– $y = u$ çš„æƒ…å†µï¼Œå³ $s \to x$ æˆ– $y \to u$ å¯èƒ½æ˜¯ç©ºè·¯å¾„ã€‚

å› ä¸ºåœ¨ $u$ ç»“ç‚¹ä¹‹å‰åŠ å…¥çš„ç»“ç‚¹éƒ½æ»¡è¶³ $D(u) = dis(u)$ï¼Œæ‰€ä»¥åœ¨ $x$ ç‚¹åŠ å…¥åˆ° $S$ é›†åˆæ—¶ï¼Œæœ‰ $D(x) = dis(x)$ï¼Œæ­¤æ—¶è¾¹ $(x,y)$ ä¼šè¢«æ¾å¼›ï¼Œä»è€Œå¯ä»¥è¯æ˜ï¼Œå°† $u$ åŠ å…¥åˆ° $S$ æ—¶ï¼Œä¸€å®šæœ‰ $D(y)=dis(y)$ã€‚

ä¸‹é¢è¯æ˜ $D(u) = dis(u)$ æˆç«‹ã€‚åœ¨è·¯å¾„ $s \to x \to y \to u$ ä¸­ï¼Œå› ä¸ºå›¾ä¸Šæ‰€æœ‰è¾¹è¾¹æƒéè´Ÿï¼Œå› æ­¤ $D(y) \leq D(u)$ã€‚ä»è€Œ $dis(y) \leq D(y) \leq D(u)\leq dis(u)$ã€‚ä½†æ˜¯å› ä¸º $u$ ç»“ç‚¹åœ¨ 1 è¿‡ç¨‹ä¸­è¢«å–å‡º $T$ é›†åˆæ—¶ï¼Œ$y$ ç»“ç‚¹è¿˜æ²¡æœ‰è¢«å–å‡º $T$ é›†åˆï¼Œå› æ­¤æ­¤æ—¶æœ‰ $dis(u)\leq dis(y)$ï¼Œä»è€Œå¾—åˆ° $dis(y) = D(y) = D(u) = dis(u)$ï¼Œè¿™ä¸ $D(u)\neq dis(u)$ çš„å‡è®¾çŸ›ç›¾ï¼Œæ•…å‡è®¾ä¸æˆç«‹ã€‚

å› æ­¤æˆ‘ä»¬è¯æ˜äº†ï¼Œ1 æ“ä½œæ¯æ¬¡å–å‡ºçš„ç‚¹ï¼Œå…¶æœ€çŸ­è·¯å‡å·²ç»è¢«ç¡®å®šã€‚å‘½é¢˜å¾—è¯ã€‚

æ³¨æ„åˆ°è¯æ˜è¿‡ç¨‹ä¸­çš„å…³é”®ä¸ç­‰å¼ $D(y) \leq D(u)$ æ˜¯åœ¨å›¾ä¸Šæ‰€æœ‰è¾¹è¾¹æƒéè´Ÿçš„æƒ…å†µä¸‹å¾—å‡ºçš„ã€‚å½“å›¾ä¸Šå­˜åœ¨è´Ÿæƒè¾¹æ—¶ï¼Œè¿™ä¸€ä¸ç­‰å¼ä¸å†æˆç«‹ï¼ŒDijkstra ç®—æ³•çš„æ­£ç¡®æ€§å°†æ— æ³•å¾—åˆ°ä¿è¯ï¼Œç®—æ³•å¯èƒ½ä¼šç»™å‡ºé”™è¯¯çš„ç»“æœã€‚

### å®ç°

è¿™é‡ŒåŒæ—¶ç»™å‡º $O(n^2)$ çš„æš´åŠ›åšæ³•å®ç°å’Œ $O(m \log m)$ çš„ä¼˜å…ˆé˜Ÿåˆ—åšæ³•å®ç°ã€‚

```cpp
struct edge {
  int v, w;
};

vector<edge> e[maxn];
int dis[maxn], vis[maxn];

void dijkstra(int n, int s) {
  memset(dis, 63, sizeof(dis));
  dis[s] = 0;
  for (int i = 1; i <= n; i++) {
    int u = 0, mind = 0x3f3f3f3f;
    for (int j = 1; j <= n; j++)
      if (!vis[j] && dis[j] < mind) u = j, mind = dis[j];
    vis[u] = true;
    for (auto ed : e[u]) {
      int v = ed.v, w = ed.w;
      if (dis[v] > dis[u] + w) dis[v] = dis[u] + w;
    }
  }
}
```

```cpp
struct edge {
  int v, w;
};

struct node {
  int dis, u;

  bool operator>(const node& a) const { return dis > a.dis; }
};

vector<edge> e[maxn];
int dis[maxn], vis[maxn];
priority_queue<node, vector<node>, greater<node> > q;

void dijkstra(int n, int s) {
  // dis[s]åˆå§‹åŒ–ä¸º0ï¼Œå…¶ä»–å€¼åˆå§‹åŒ–ä¸ºINF
  memset(dis, 63, sizeof(dis));
  dis[s] = 0;
  // ä¼˜å…ˆé˜Ÿåˆ—ä¸­ä¿å­˜çš„æ˜¯é›†åˆTçš„èŠ‚ç‚¹
  q.push({0, s});
  while (!q.empty()) {
    // ä»ä¼˜å…ˆé˜Ÿåˆ—ä¸­å–å‡ºçš„æœ€çŸ­è·¯é•¿åº¦æœ€å°çš„ç»“ç‚¹u
    // ç¬¬ä¸€æ¬¡å–å‡ºæ—¶, å·²ç»æ˜¯æœ€çŸ­è·¯äº†ï¼Œå³D(u) = dis(u)
    // ç¬¬ä¸€æ¬¡å–å‡ºæ—¶, ä½¿ç”¨visæ•°ç»„è¿›è¡Œæ ‡è®°ï¼Œåç»­é‡åˆ°ç›´æ¥è·³è¿‡
    // å³visæ•°ç»„ä¸­çš„å€¼ä¸º1çš„èŠ‚ç‚¹æ˜¯é›†åˆSçš„èŠ‚ç‚¹
    int u = q.top().u;
    q.pop();
    if (vis[u]) continue;
    vis[u] = 1;
    for (auto ed : e[u]) {
      int v = ed.v, w = ed.w;
      // å¦‚æœä»uåˆ°vçš„è·ç¦»æ¯”ç°åœ¨çš„dis[v]æ›´çŸ­ï¼Œæ‰éœ€è¦åŠ å…¥ä¼˜å…ˆé˜Ÿåˆ—ä¸­ï¼Œå¹¶ä¸”æ›´æ–°dis[v]
      if (dis[v] > dis[u] + w) {
        dis[v] = dis[u] + w;
        q.push({dis[v], v});
      }
    }
  }
}
```

### ä¼˜å…ˆé˜Ÿåˆ—BFS

ä¼˜å…ˆé˜Ÿåˆ—ï¼Œç›¸å½“äºä¸€ä¸ªäºŒå‰å †ï¼Œ`STL` ä¸­æä¾›äº† `std::priority_queue`ï¼Œå¯ä»¥æ–¹ä¾¿æˆ‘ä»¬ä½¿ç”¨ä¼˜å…ˆé˜Ÿåˆ—ã€‚

åœ¨åŸºäºä¼˜å…ˆé˜Ÿåˆ—çš„ `BFS` ä¸­ï¼Œæˆ‘ä»¬æ¯æ¬¡ä»é˜Ÿé¦–å–å‡ºä»£ä»·æœ€å°çš„ç»“ç‚¹è¿›è¡Œè¿›ä¸€æ­¥æœç´¢ã€‚å®¹æ˜“è¯æ˜è¿™ä¸ªè´ªå¿ƒæ€æƒ³æ˜¯æ­£ç¡®çš„ï¼Œå› ä¸ºä»è¿™ä¸ªç»“ç‚¹å¼€å§‹æ‰©å±•çš„æœç´¢ï¼Œä¸€å®šä¸ä¼šæ›´æ–°åŸæ¥é‚£äº›ä»£ä»·æ›´é«˜çš„ç»“ç‚¹ã€‚æ¢å¥è¯è¯´ï¼Œå…¶ä½™é‚£äº›ä»£ä»·æ›´é«˜çš„ç»“ç‚¹ï¼Œæˆ‘ä»¬ä¸å›å»è€ƒè™‘æ›´æ–°å®ƒã€‚

å½“ç„¶ï¼Œæ¯ä¸ªç»“ç‚¹å¯èƒ½ä¼šè¢«å…¥é˜Ÿå¤šæ¬¡ï¼Œåªæ˜¯æ¯æ¬¡å…¥é˜Ÿçš„ä»£ä»·ä¸åŒã€‚å½“è¯¥ç»“ç‚¹ç¬¬ä¸€æ¬¡ä»ä¼˜å…ˆé˜Ÿåˆ—ä¸­å–å‡ºï¼Œä»¥åä¾¿æ— éœ€å†åœ¨è¯¥ç»“ç‚¹è¿›è¡Œæœç´¢ï¼Œç›´æ¥å¿½ç•¥å³å¯ã€‚æ‰€ä»¥ï¼Œä¼˜å…ˆé˜Ÿåˆ—çš„ `BFS` å½“ä¸­ï¼Œæ¯ä¸ªç»“ç‚¹åªä¼šè¢«å¤„ç†ä¸€æ¬¡ã€‚

ç›¸å¯¹äºæ™®é€šé˜Ÿåˆ—çš„ `BFS`ï¼Œæ—¶é—´å¤æ‚åº¦å¤šäº†ä¸€ä¸ª $\log n$ï¼Œæ¯•ç«Ÿè¦ç»´æŠ¤è¿™ä¸ªä¼˜å…ˆé˜Ÿåˆ—å˜›ã€‚ä¸è¿‡æ™®é€š `BFS` æœ‰å¯èƒ½æ¯ä¸ªç»“ç‚¹å…¥é˜Ÿã€å‡ºé˜Ÿå¤šæ¬¡ï¼Œæ—¶é—´å¤æ‚åº¦ä¼šè¾¾åˆ° $O(n^2)$ï¼Œä¸æ˜¯ $O(n)$ã€‚æ‰€ä»¥ä¼˜å…ˆé˜Ÿåˆ— `BFS` é€šå¸¸è¿˜æ˜¯å¿«çš„ã€‚

è¯¶ï¼Ÿè¿™æ€ä¹ˆå¬èµ·æ¥è¿™ä¹ˆåƒå †ä¼˜åŒ–çš„ `Dijkstra` ç®—æ³•å‘¢ï¼Ÿäº‹å®ä¸Šï¼Œå †ä¼˜åŒ– `Dijkstra` å°±æ˜¯ä¼˜å…ˆé˜Ÿåˆ— `BFS`ã€‚

## ä¸åŒæ–¹æ³•çš„æ¯”è¾ƒ

![æœ€çŸ­è·¯ä¸åŒæ–¹æ³•çš„æ¯”è¾ƒ](images/æœ€çŸ­è·¯ä¸åŒæ–¹æ³•çš„æ¯”è¾ƒ.png)

æ³¨ï¼šè¡¨ä¸­çš„ `Dijkstra` ç®—æ³•åœ¨è®¡ç®—å¤æ‚åº¦æ—¶å‡ç”¨ `priority_queue` å®ç°ã€‚

## è¾“å‡ºæ–¹æ¡ˆ

å¼€ä¸€ä¸ª `pre` æ•°ç»„ï¼Œåœ¨æ›´æ–°è·ç¦»çš„æ—¶å€™è®°å½•ä¸‹æ¥åé¢çš„ç‚¹æ˜¯å¦‚ä½•è½¬ç§»è¿‡å»çš„ï¼Œç®—æ³•ç»“æŸå‰å†é€’å½’åœ°è¾“å‡ºè·¯å¾„å³å¯ã€‚

æ¯”å¦‚ `Floyd` å°±è¦è®°å½• `pre[i][j] = k;`ï¼Œ`Bellman-Ford` å’Œ `Dijkstra` ä¸€èˆ¬è®°å½• `pre[v] = u`ã€‚

## é¢˜ç›®

- [787. Kç«™ä¸­è½¬å†…æœ€ä¾¿å®œçš„èˆªç­](https://leetcode.cn/problems/cheapest-flights-within-k-stops/description/)
- [743. ç½‘ç»œå»¶è¿Ÿæ—¶é—´](https://leetcode.cn/problems/network-delay-time/description/)

## å‚è€ƒèµ„æ–™

- [æœ€çŸ­è·¯](https://oi-wiki.org/graph/shortest-path/)
